# üß™ Playwright API Testing - ServeRest

[![Playwright](https://img.shields.io/badge/Playwright-Python-45ba63.svg)](https://playwright.dev/python/)
[![Pytest](https://img.shields.io/badge/Pytest-8.4.2-blue.svg)](https://docs.pytest.org/en/stable/)
[![Python](https://img.shields.io/badge/Python-3.10+-yellow.svg)](https://www.python.org/)

Projeto de automa√ß√£o de testes de API utilizando **Microsoft Playwright para Python** em conjunto com **pytest** para testar a API REST **ServeRest** - uma API gratuita que simula uma loja virtual.

Projeto estruturado com boas pr√°ticas, exemplos de testes, valida√ß√µes avan√ßadas e integra√ß√£o com Pytest para execu√ß√£o e relat√≥rios Allure.

URI do reposit√≥rio: [https://github.com/reinaldorossetti/playwright-python-api-serverest](https://github.com/reinaldorossetti/playwright-python-api-serverest)

Testes realizados na API com Python + Pytest: [TESTING_API_PYTHON.MD](TESTING_API_PYTHON.MD)

---

## üìö √çndice

- [Sobre o Playwright](#-sobre-o-playwright)
- [Sobre a API ServeRest](#-sobre-a-api-serverest)
- [Estrutura do Projeto](#-estrutura-do-projeto)
- [Pr√©-requisitos](#-pr√©-requisitos)
- [Python no Projeto](#-python-no-projeto)
- [Instala√ß√£o](#-instala√ß√£o)
- [Executando os Testes](#-executando-os-testes)
- [Exemplos de Testes](#-exemplos-de-testes)
- [assert_that ‚Äî Assertpy](#-assert_that--assertpy)
- [Funcionalidades do Playwright](#-funcionalidades-do-playwright)
- [Relat√≥rios](#-relat√≥rios)
- [Allure Report ‚Äî Decorators](#-allure-report--decorators)
- [Boas Pr√°ticas](#-boas-pr√°ticas)
- [Recursos Adicionais](#-recursos-adicionais)

---

## üß™ Sobre o Playwright

**Playwright** √© um framework open-source da Microsoft, conhecido por testes E2E em browser e tamb√©m por uma API robusta para testes HTTP via `APIRequestContext`, ideal para automa√ß√£o de APIs em Python.

### ‚ú® Principais Caracter√≠sticas

- **üî• APIRequestContext fluente**: Requisi√ß√µes HTTP com `get`, `post`, `put`, `delete`
- **üöÄ Suporte completo a REST**: opera√ß√µes GET, POST, PUT, PATCH e DELETE com JSON
- **üéØ Assertions fluentes com assertpy**: valida√ß√µes leg√≠veis e encade√°veis com `assert_that` da biblioteca `assertpy`
- **üîÑ Contexto reutiliz√°vel**: configura√ß√£o de `base_url`, headers e ciclo de vida via depend√™ncias/fixtures do pytest
- **üìä Integra√ß√£o com Allure**: relat√≥rios ricos de execu√ß√£o com pytest
- **üß™ Data-Driven Testing**: suporte com `@pytest.mark.parametrize` e leitura de CSV
- **‚ö° Execu√ß√£o Paralela**: execu√ß√£o simult√¢nea de testes via `pytest-xdist`
- **üîê Autentica√ß√£o**: suporte total para tokens e headers customizados

### üí° Por que usar Playwright para API em Python?

1. **Padroniza√ß√£o**: mesmo framework para API e UI quando necess√°rio
2. **Confiabilidade**: cliente HTTP moderno, veloz e est√°vel
3. **Integra√ß√£o**: funciona naturalmente e se integra perfeitamente com pytest
4. **Evolu√ß√£o**: ecossistema ativo e muito bem documentado
5. **CI/CD**: f√°cil integra√ß√£o com GitHub Actions

---

## üåê Sobre a API ServeRest

[ServeRest](https://serverest.dev/) √© uma API REST gratuita que simula uma loja virtual para fins educacionais e pr√°tica de testes de API.

### üõçÔ∏è Endpoints Dispon√≠veis

| Recurso | Endpoints | Descri√ß√£o |
|---------|-----------|-----------|
| **Login** | `POST /login` | Autentica√ß√£o de usu√°rios |
| **Usu√°rios** | `GET, POST, PUT, DELETE /usuarios` | Gerenciamento de usu√°rios |
| **Produtos** | `GET, POST, PUT, DELETE /produtos` | Gerenciamento de produtos (requer admin) |
| **Carrinhos** | `GET, POST, DELETE /carrinhos` | Gerenciamento de carrinhos de compras |

### üîó Base URL

```text
https://serverest.dev
```

### üìñ Documenta√ß√£o Completa

- **Swagger UI**: https://serverest.dev/
- **Reposit√≥rio**: https://github.com/ServeRest/ServeRest
- **Front-end (Beta)**: https://front.serverest.dev/

---

## üìÅ Estrutura do Projeto

```text
playwright-python-api-serverest/
‚îÇ
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ ci.yml                       # Pipeline de CI
‚îÇ
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py                      # Configura√ß√£o base e fixtures do Pytest
‚îÇ   ‚îú‚îÄ‚îÄ login/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_login_playwright.py
‚îÇ   ‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_users_playwright.py
‚îÇ   ‚îú‚îÄ‚îÄ products/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_products_playwright.py
‚îÇ   ‚îú‚îÄ‚îÄ carts/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_carts_playwright.py
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_utils.py                 # Fun√ß√µes √∫teis de requests e endpoints
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ faker_utils.py               # Gera√ß√£o de dados de teste (Faker)
‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ       ‚îú‚îÄ‚îÄ login/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ invalid-login-emails.csv
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ invalido-login.csv
‚îÇ       ‚îú‚îÄ‚îÄ usuarios/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ userPayload.json
‚îÇ       ‚îî‚îÄ‚îÄ produtos/
‚îÇ           ‚îú‚îÄ‚îÄ productPayload.json
‚îÇ           ‚îî‚îÄ‚îÄ product.csv
‚îÇ
‚îú‚îÄ‚îÄ pytest.ini                           # Configura√ß√µes gerais do pytest (dist e allure)
‚îú‚îÄ‚îÄ requirements.txt                     # Depend√™ncias do projeto Python
‚îú‚îÄ‚îÄ TESTING_API_PYTHON.MD                # Documenta√ß√£o dos cen√°rios de teste em Python
‚îî‚îÄ‚îÄ readme.MD                            # Este arquivo
```

---

## üîß Pr√©-requisitos

- **Python 3.10** ou superior
- **pip** (Gerenciador de pacotes do Python)
- **Virtual Environment** (recomendado usar `venv` ou similar)
- **IDE** (VS Code, PyCharm)
- Conex√£o com internet (para acessar a API ServeRest)

### Verificar instala√ß√£o

```bash
python --version
pip --version
```

### Comando para rodar os testes no terminal:
```bash
python -m pytest tests
```
---

## üêç Python no Projeto

Este projeto utiliza recursos nativos e modernos do **Python** em sinergia com o **Pytest** para entregar testes leg√≠veis, independentes e f√°ceis de dar manuten√ß√£o.

### ‚úÖ Exemplos pr√°ticos usados no projeto

1. **Dicion√°rios nativos para payloads JSON**

```python
payload = {
    "nome": product_name,
    "preco": 250,
    "descricao": "Produto de teste",
    "quantidade": 10
}
```

2. **Fixtures do Pytest para inje√ß√£o de depend√™ncia (`conftest.py`)**

```python
@pytest.fixture
def api_request(playwright_instance: Playwright):
    request_context = playwright_instance.request.new_context(base_url=BASE_URL)
    yield request_context
    request_context.dispose()
```

3. **Tipagem e Autocomplete (`Type Hints`)**

```python
def create_user(request: APIRequestContext, email: str, password: str, admin: bool):
    pass
```

### üí° Boas pr√°ticas com Python para este projeto

- Mantenha `pytest.ini` e `conftest.py` otimizados para orquestrar setup/teardown.
- Use dicion√°rios nativos para body das requisi√ß√µes, ao inv√©s de convers√£o manual de texto.
- Use `assert_that` da biblioteca `assertpy` para asser√ß√µes fluentes, leg√≠veis e com mensagens de erro detalhadas (ex: `assert_that(resp.status).is_equal_to(200)`).

---

## üì¶ Depend√™ncias e Vers√µes (requirements.txt)

| Componente                         | Vers√£o  | Descri√ß√£o  |
|------------------------------------|---------|------------|
| `pytest`                           | 8.4.2   | Framework principal de testes unit√°rios/integrados |
| `playwright`                       | 1.58.0  | Engine para chamadas e requisi√ß√µes HTTP |
| `pytest-xdist`                     | 3.8.0   | Suporte √† execu√ß√£o simult√¢nea e multiprocessos |
| `allure-pytest`                    | 2.15.3  | Gera√ß√£o unificada de relat√≥rios visuais com Allure |
| `assertpy`                         | 1.1     | Assertions fluentes com `assert_that` |

---

## üöÄ Instala√ß√£o

### 1. Clone o reposit√≥rio

```bash
git clone https://github.com/reinaldorossetti/playwright-python-api-serverest.git
cd playwright-python-api-serverest
```

### 2. Crie e ative um ambiente virtual (Opcional, mas recomendado)

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 3. Instale as depend√™ncias e o Playwright

```bash
pip install -r requirements.txt
playwright install
```

---

## ‚ñ∂Ô∏è Executando os Testes

As configura√ß√µes padr√£o de execu√ß√£o j√° est√£o pr√©-definidas no `pytest.ini`.

### Executar su√≠te completa

```bash
python -m pytest tests
```

### Executar funcionalidade espec√≠fica (Ex: login)

```bash
pytest tests/login/test_login_playwright.py
```

### Executar teste individual

```bash
pytest tests/login/test_login_playwright.py::test_ct01_login_with_valid_credentials_and_validate_token
```

### Execu√ß√£o paralela (via pytest-xdist)

O arquivo `pytest.ini` j√° est√° setado com o argumento `-n 6 --dist=loadscope` configurando paralelismo otimizado com as workers. Para modificar em tempo de terminal para for√ßar execu√ß√£o total da CPU, utilize `-n auto`:

```bash
pytest -n auto
```

---

## ‚öôÔ∏è Esteira CI/CD - GitHub Actions

Este projeto possui integra√ß√£o cont√≠nua configurada no GitHub Actions em:

- Arquivo: `.github/workflows/ci.yml`

### üîÅ Quando a esteira √© executada

- `push` em qualquer branch
- `pull_request` aberto ou atualizado

### üß± Passos principais da pipeline (`test`)

1. **Checkout do c√≥digo**
2. **Configura√ß√£o do Python** (`actions/setup-python@v4`)
3. **Instala√ß√£o das depend√™ncias** (utilizando `pip cache`)
4. **Instala√ß√£o dos browsers / depend√™ncias nativas do Playwright**
5. **Execu√ß√£o robusta via `pytest`** gerando artefatos para o Allure.
6. **Deploy no GitHub Pages:** Relat√≥rio final √© hospedado usando `peaceiris/actions-gh-pages@v4`.

### üåê Acesso ao relat√≥rio no GitHub Pages

Ap√≥s a execu√ß√£o da sua pipeline, navegue em:
`https://reinaldorossetti.github.io/playwright-python-api-serverest/allure-reports/index.html`

---

## üìù Exemplos de Testes

### Exemplo 1: Configura√ß√£o Base com Pytest Fixtures (`conftest.py`)

Em Python, abstra√≠mos todo o gerenciador em session scopes via fixtures.

```python
import pytest
from playwright.sync_api import Playwright, sync_playwright

BASE_URL = "https://serverest.dev"

@pytest.fixture(scope="session")
def playwright_instance() -> Playwright:
    with sync_playwright() as playwright:
        yield playwright

@pytest.fixture
def api_request(playwright_instance: Playwright):
    request_context = playwright_instance.request.new_context(base_url=BASE_URL)
    yield request_context
    request_context.dispose()
```

### Exemplo 2: Login com sucesso

```python
import allure
from assertpy import assert_that
from playwright.sync_api import APIRequestContext
from tests.utils.api_utils import post_json, parse_response_body

@allure.severity(allure.severity_level.CRITICAL)
def test_ct01_login_with_valid_credentials_and_validate_token(api_request: APIRequestContext):
    email = "usuario_valido@email.com"
    password = "SenhaSegura@123"

    login_resp = post_json(api_request, "/login", {"email": email, "password": password})

    assert_that(login_resp.status).is_equal_to(200)
    body = parse_response_body(login_resp)
    assert_that(body["message"]).is_equal_to("Login realizado com sucesso")
    assert_that(body.get("authorization")).is_not_none()
```

### Exemplo 3: Login inv√°lido

```python
@allure.severity(allure.severity_level.CRITICAL)
def test_ct02_login_with_invalid_credentials(api_request: APIRequestContext):
    resp = post_json(
        api_request,
        "/login",
        {
            "email": "usuario@inexistente.com",
            "password": "senhaerrada",
        },
    )

    assert_that(resp.status).is_equal_to(401)
    response_body = parse_response_body(resp)
    assert_that(response_body["message"]).is_equal_to("Email e/ou senha inv√°lidos")
```

### Exemplo 4: Valida√ß√£o de campos obrigat√≥rios (Data-driven com Pytest)

```python
@allure.severity(allure.severity_level.NORMAL)
@pytest.mark.parametrize("_row", load_required_fields_rows())
def test_ct03_validate_required_fields_on_login(_row: dict[str, str], api_request: APIRequestContext):
    resp = post_json(api_request, "/login", {"email": "", "password": "senha123"})
    assert_that(resp.status).is_equal_to(400)
    body = parse_response_body(resp)
    assert_that(body.get("email")).is_not_none()
```

### Exemplo 5: Uso de token din√¢mico recebido em Auth

```python
@allure.severity(allure.severity_level.CRITICAL)
def test_ct04_login_and_use_token_in_protected_route(api_request: APIRequestContext):
    auth_token = "Bearer XXXX"  # Recebido de requests anteriores do setup

    product_payload = {"nome": "Teste", "preco": 100, "descricao": "Teste", "quantidade": 10}

    product_resp = api_request.post(
        "/produtos",
        headers={**JSON_HEADERS, "Authorization": auth_token},
        data=json.dumps(product_payload, ensure_ascii=False),
    )

    assert_that(product_resp.status).is_equal_to(403)
    body = parse_response_body(product_resp)
    assert_that(body["message"]).is_equal_to("Rota exclusiva para administradores")
```

### Exemplo 6: Teste iterando em arquivos CSV via Pathlib

```python
from pathlib import Path
import csv

def load_invalid_email_values() -> list[str]:
    csv_path = Path("tests/resources/login/invalid-login-emails.csv")
    with csv_path.open(encoding="utf-8") as f:
        return [row["email"] for row in csv.DictReader(f)]

@allure.severity(allure.severity_level.NORMAL)
@pytest.mark.parametrize("invalid_email", load_invalid_email_values())
def test_ct05_validate_invalid_email_format(invalid_email: str, api_request: APIRequestContext):
    resp = post_json(api_request, "/login", {"email": invalid_email, "password": "senha123"})

    assert_that(resp.status).is_equal_to(400)
    body = parse_response_body(resp)
    assert_that(body.get("email")).is_not_none()
```

### Exemplo 7: Ciclo completo de carrinho (baseado em `test_carts_playwright.py`)

```python
import json
import allure
from assertpy import assert_that
from playwright.sync_api import APIRequestContext
from tests.utils.api_utils import JSON_HEADERS, parse_response_body, post_json
from tests.utils.faker_utils import random_email, random_product

@allure.severity(allure.severity_level.CRITICAL)
def test_ct01_full_cart_lifecycle_for_authenticated_user(api_request: APIRequestContext):
    # Criar usu√°rio admin e obter token
    user_email = random_email()
    post_json(api_request, "/usuarios", {"nome": "Cart User", "email": user_email,
                                          "password": "SenhaSegura@123", "administrador": "true"})
    login_resp = post_json(api_request, "/login", {"email": user_email, "password": "SenhaSegura@123"})
    assert_that(login_resp.status).is_equal_to(200)
    token = parse_response_body(login_resp)["authorization"]

    # Garantir que n√£o h√° carrinho ativo
    api_request.delete("/carrinhos/cancelar-compra", headers={"Authorization": token})

    # Criar produto
    product_resp = api_request.post(
        "/produtos",
        headers={**JSON_HEADERS, "Authorization": token},
        data=json.dumps({"nome": random_product(), "preco": 150,
                         "descricao": "Produto de teste", "quantidade": 10}, ensure_ascii=False),
    )
    assert_that(product_resp.status).is_equal_to(201)
    product_id = parse_response_body(product_resp)["_id"]

    # Criar carrinho
    create_cart_resp = api_request.post(
        "/carrinhos",
        headers={**JSON_HEADERS, "Authorization": token},
        data=json.dumps({"produtos": [{"idProduto": product_id, "quantidade": 2}]}, ensure_ascii=False),
    )
    assert_that(create_cart_resp.status).is_equal_to(201)
    cart_id = parse_response_body(create_cart_resp)["_id"]

    # Buscar carrinho por ID e validar campos
    get_cart_resp = api_request.get(f"/carrinhos/{cart_id}")
    assert_that(get_cart_resp.status).is_equal_to(200)
    cart_body = parse_response_body(get_cart_resp)
    assert_that(cart_body["_id"]).is_equal_to(cart_id)
    assert_that(cart_body.get("precoTotal")).is_not_none()
    assert_that(cart_body.get("quantidadeTotal")).is_not_none()
    assert_that(len(cart_body["produtos"])).is_equal_to(1)

    # Concluir compra
    conclude_resp = api_request.delete("/carrinhos/concluir-compra", headers={"Authorization": token})
    assert_that(conclude_resp.status).is_equal_to(200)
    assert_that(parse_response_body(conclude_resp)["message"]).contains("Registro exclu√≠do com sucesso")
```

---

## ‚úÖ assert_that ‚Äî Assertpy

Todos os testes deste projeto utilizam `assert_that` da biblioteca [assertpy](https://github.com/assertpy/assertpy) para realizar asser√ß√µes fluentes, leg√≠veis e com mensagens de erro detalhadas.

### Importa√ß√£o

```python
from assertpy import assert_that
```

### Principais m√©todos

| M√©todo                              | O que valida                                           |
|-------------------------------------|--------------------------------------------------------|
| `.is_equal_to(value)`               | Igualdade exata                                        |
| `.is_not_equal_to(value)`           | Diferen√ßa entre valores                                |
| `.is_not_none()`                    | Valor n√£o √© `None`                                     |
| `.is_none()`                        | Valor √© `None`                                         |
| `.contains(substr)`                 | String ou lista cont√©m o valor informado               |
| `.does_not_contain(substr)`         | String ou lista n√£o cont√©m o valor                     |
| `.is_true()` / `.is_false()`        | Booleano verdadeiro / falso                            |
| `.is_greater_than(n)`               | Num√©rico maior que `n`                                 |
| `.is_less_than(n)`                  | Num√©rico menor que `n`                                 |
| `.is_between(a, b)`                 | Num√©rico dentro do intervalo `[a, b]`                  |
| `.is_length(n)`                     | Sequ√™ncia com tamanho exato `n`                        |
| `.is_empty()` / `.is_not_empty()`   | Sequ√™ncia vazia ou n√£o vazia                           |
| `.has_size(n)`                      | Cole√ß√£o com `n` elementos                              |
| `.snapshot()`                       | Compara com snapshot salvo em `__snapshots/`           |

### Exemplo com status e corpo da resposta

```python
from assertpy import assert_that
from tests.utils.api_utils import parse_response_body

resp = api_request.get("/usuarios")
assert_that(resp.status).is_equal_to(200)

body = parse_response_body(resp)
assert_that(body.get("quantidade")).is_greater_than(0)
assert_that(body.get("usuarios")).is_not_empty()
```

### Encadeamento de asser√ß√µes

```python
assert_that(body["message"]) \
    .is_not_none() \
    .contains("sucesso")
```

### Snapshot testing

O m√©todo `.snapshot()` grava a resposta na primeira execu√ß√£o e nas seguintes verifica se o conte√∫do √© id√™ntico. Os arquivos ficam em `__snapshots/`.

```python
body = parse_response_body(resp)
assert_that(body).snapshot()   # cria ou valida __snapshots/<nome>.json
```

> Para resetar um snapshot, apague o arquivo correspondente em `__snapshots/` e execute o teste novamente.

---

## üéØ Funcionalidades e Sintaxe Nativas (Playwright Python API)

### 1. Inicializa√ß√£o de um contexto isolado

```python
request_context = playwright_instance.request.new_context(base_url="https://serverest.dev")
```

### 2. Requisi√ß√µes Fluent e Options combinadas

```python
response = request.post(
    "/login",
    headers={"Content-Type": "application/json"},
    data={"email": email, "password": password}
)
```

### 3. Extra√ß√£o imediata JSON de responses HTTP

```python
body_json = response.json()
authorization_token = body_json.get("authorization")
http_status = response.status
```

---

## üìä Relat√≥rios

Ap√≥s aplicar localmente a su√≠te ou durante a pipeline, o Allure se integra embutidamente com Pytest. O projeto aponta suas sa√≠das para o diret√≥rio de dados em `/allure-results`.

### Instala√ß√£o do Allure CLI

Para usar o `allure serve` localmente, instale o Allure CLI globalmente via **npm** (requer Node.js 18+):

```bash
npm install -g allure-commandline
```

Verifique a instala√ß√£o:

```bash
allure --version
```

> Alternativamente, no Windows com Scoop: `scoop install allure`  
> No macOS com Homebrew: `brew install allure`

### Gerando e visualizando o relat√≥rio

Para transformar os dados JSON de sa√≠da do Pytest na interface gr√°fica robusta do Allure:

```bash
# Executar os testes e salvar resultados
pytest tests --alluredir=allure-results

# Abrir relat√≥rio interativo no browser
allure serve allure-results
```

> Para gerar os arquivos HTML est√°ticos (ex: para deploy em CI/CD):
> ```bash
> allure generate allure-results --clean -o allure-report
> allure open allure-report
> ```

O dashboard exibe:
- ‚úÖ Cen√°rios OK, Skipped e Failed detalhadamente
- ‚è±Ô∏è Tempos exatos capturados via Hooks do Pytest 
- üìã Stack Trace de Erros
- üìä An√°lise das execu√ß√µes em timeline

### üè∑Ô∏è Allure Report ‚Äî Decorators

O plugin `allure-pytest` suporta metadados extremamente ricos em cima das fun√ß√µes de teste. Todos os decorators abaixo s√£o importados de `import allure`.

#### Decorators dispon√≠veis

| Decorator                               | Descri√ß√£o                                              | Exemplo                                              |
|-----------------------------------------|--------------------------------------------------------|------------------------------------------------------|
| `@allure.severity(level)`               | Define a criticidade do teste                          | `@allure.severity(allure.severity_level.CRITICAL)`   |
| `@allure.title("T√≠tulo")`               | T√≠tulo leg√≠vel exibido no relat√≥rio                    | `@allure.title("CT01 - Login v√°lido")`               |
| `@allure.description("Descri√ß√£o")`      | Descri√ß√£o longa do teste                               | `@allure.description("Valida token JWT retornado")`  |
| `@allure.description_html("html")`      | Descri√ß√£o em HTML                                      | `@allure.description_html("<b>Login</b>")`           |
| `@allure.feature("Feature")`            | Agrupa testes por funcionalidade                       | `@allure.feature("Login")`                           |
| `@allure.story("Story")`                | Subdivide features em hist√≥rias                        | `@allure.story("Login com credenciais v√°lidas")`     |
| `@allure.epic("Epic")`                  | Agrupa features em √©picos (maior granularidade)        | `@allure.epic("Autentica√ß√£o")`                       |
| `@allure.tag("tag1", "tag2")`           | Tags livres para categoriza√ß√£o                         | `@allure.tag("smoke", "regression")`                 |
| `@allure.label("name", "value")`        | Label customizado de formato chave-valor               | `@allure.label("layer", "api")`                      |
| `@allure.link(url, name="texto")`       | Link gen√©rico no relat√≥rio                             | `@allure.link("https://serverest.dev")`              |
| `@allure.issue(url, name="texto")`      | Link para issue/bug tracker                            | `@allure.issue("https://github.com/org/repo/1")`    |
| `@allure.testcase(url, name="texto")`   | Link para caso de teste em ferramenta de gest√£o        | `@allure.testcase("https://jira.example.com/TC-1")` |

#### N√≠veis de severidade (`allure.severity_level`)

| Constante                          | Uso                                        |
|------------------------------------|--------------------------------------------|
| `allure.severity_level.BLOCKER`    | Impede a execu√ß√£o; bloqueia o release      |
| `allure.severity_level.CRITICAL`   | Fluxo principal; falha impacta diretamente |
| `allure.severity_level.NORMAL`     | Importante, mas n√£o bloqueia o fluxo core  |
| `allure.severity_level.MINOR`      | Pouco impacto; melhoria ou detalhe         |
| `allure.severity_level.TRIVIAL`    | Cosm√©tico ou edge case irrelevante         |

#### Steps dentro dos testes

```python
import allure

# Context manager ‚Äî passo nomeado no relat√≥rio
with allure.step("Criar usu√°rio administrador"):
    post_json(request, "/usuarios", new_user)

# Decorator ‚Äî reutiliz√°vel em fun√ß√µes helper
@allure.step("Fazer login e obter token")
def get_token(request, email, password):
    resp = post_json(request, "/login", {"email": email, "password": password})
    return parse_response_body(resp)["authorization"]
```

#### Exemplo completo com todas as anota√ß√µes

```python
import allure
from assertpy import assert_that
from playwright.sync_api import APIRequestContext
from tests.utils.api_utils import post_json, parse_response_body

@allure.epic("Autentica√ß√£o")
@allure.feature("Login")
@allure.story("Login com credenciais inv√°lidas")
@allure.severity(allure.severity_level.CRITICAL)
@allure.title("CT02 - Login com credenciais inv√°lidas retorna 401")
@allure.description("Valida que o endpoint retorna 401 para credencial incorreta de usu√°rio")
@allure.tag("smoke", "regression")
@allure.issue("https://github.com/ServeRest/ServeRest/issues/1", name="SRV-123")
def test_ct02_login_with_invalid_credentials(api_request: APIRequestContext):
    with allure.step("Realizar POST com credencial incorreta"):
        resp = post_json(api_request, "/login", {"email": "usuario@inexistente.com", "password": "senhaerrada"})

    with allure.step("Validar status 401 e mensagem de erro"):
        assert_that(resp.status).is_equal_to(401)
        body = parse_response_body(resp)
        assert_that(body["message"]).is_equal_to("Email e/ou senha inv√°lidos")
```

---

## üéì Boas Pr√°ticas

### 1. Organiza√ß√£o dos Arquivos de Tests / Su√≠tes

- ‚úÖ Divida os dom√≠nios (Ex: `login/test_login_playwright.py`, `users/test_users_playwright.py`, etc)
- ‚úÖ Comece os nomes das fun√ß√µes validadoras com o prefixo `test_`, requisito estrutural b√°sico para a descoberta autom√°tica de su√≠tes pelo `pytest`.

### 2. Fun√ß√µes Abstratas Customizadas (`api_utils.py` e Helpers)

- ‚úÖ Centralize chamadas longas na l√≥gica customizada do projeto para evitar `copy/paste` nos testes (ex: `post_json`).
- ‚úÖ Usar a biblioteca de Fake Entities (`faker`) isoladas em pacotes utilit√°rios para construir mocks din√¢micos de dados em cada request de teste de integra√ß√£o.

### 3. Pytest Features:

- ‚úÖ Usar exaustivamente propriedades como `@pytest.mark.parametrize` para simular as planilhas nativas em um √∫nico method-call.
- ‚úÖ Reutiliza√ß√£o absoluta de Context API: Fixtures configuradas com Pytest que operam a API em sessions otimizam a rede e alivia o overhead das inst√¢ncias locais do playwright.

---

## üìö Recursos Adicionais

### Documenta√ß√£o Oficial

- üé≠ **Playwright Python**: https://playwright.dev/python/docs/api/class-apirequestcontext
- üåê **ServeRest**: https://serverest.dev/
- üêç **Pytest**: https://docs.pytest.org/
- üìä **Allure Pytest**: https://docs.qameta.io/allure/#_pytest

### Comunidade

- [Stack Overflow - Playwright Python Tag](https://stackoverflow.com/questions/tagged/playwright-python)
- [Playwright GitHub Issues](https://github.com/microsoft/playwright-python/issues)

---

## ü§ù Contribuindo

Contribui√ß√µes s√£o bem-vindas! Para contribuir:

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/MinhaFeature`)
3. Commit suas mudan√ßas (`git commit -m 'Adiciona nova feature'`)
4. Push para a branch (`git push origin feature/MinhaFeature`)
5. Abra um Pull Request

---

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

---

## üë®‚Äçüíª Autor

Desenvolvido para fins de estudo e pr√°tica de automa√ß√£o de testes de API.

---

## ‚≠ê Agradecimentos

- **Microsoft** - Criadora do Playwright
- **Paulo Gon√ßalves** - Criador da API ServeRest
- Equivalente e Comunidade ao Pytest - Testes automatizados robustos
- Comunidade open-source e testers

---

Refer√™ncias:
- https://playwright.dev/python/docs/intro
- https://docs.pytest.org/
- https://github.com/microsoft/playwright-python

**üöÄ Happy Testing with Playwright and Python!** üé≠
